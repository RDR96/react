import { Counterparties, MercoaSession } from '@mercoa/react'
import { Mercoa } from '@mercoa/javascript'
import { payerEntity, vendorEntities } from '../../mockData'
import { ComponentContainer } from '../../components/helpers'

# Manage Counterparties

The `<Counterparties>` renders a list of counterparties that can be selected, as well as allowing your user to add a new counterparty

## Customization Options

| Themeable | Variations | Custom Component |
| :-------: | :--------: | :--------------: |
|    ✅     |     ❌     |        ✅        |

## Props

| Name            | Type                                                           | Required | Description                                                                                                      |
| :---------------| :--------------------------------------------------------------| :--------| :----------------------------------------------------------------------------------------------------------------|
| type            | `"payee"` `"payor"`                                            | ✅       | Use `Payee` to view as a payee (AP), and `Payor` to view as a payor (AR) |
| disableCreation | `boolean`                                                      |          | Disable the ability to create a counterparty from the search.                                                 |
| children        | `((props: CounterpartiesChildrenProps) => JSX.Element)`        |          | Fully customize the UI with the help of these hooks and helper functions. See [example](#custom-design).         |
| counterpartyPreSubmit | `(counterparty: Mercoa.EntityRequest \| Mercoa.EntityUpdateRequest \| undefined) => Promise<Mercoa.EntityRequest \| Mercoa.EntityUpdateRequest \| undefined>` |          | Function to call before an entity is submitted to Mercoa. Useful for adding custom fields to the entity or preventing submission |

```typescript
type CounterpartiesChildrenProps = {
  dataLoaded: boolean // If data is loaded, this is true. Otherwise this is false.
  counterparties: Mercoa.CounterpartyResponse[] // List of counterparties. Will be an empty list if dataLoaded is false.

  setSearch: (search: string) => void // Update the search filter

  hasNext: boolean // Has next page of counterparties
  getNext: () => void // Get next page of counterparties
  hasPrevious: boolean // Has previous page of counterparties
  getPrevious: () => void // Get previous page of counterparties
  count: number // Total number of counterparties

  resultsPerPage: number // Max number of results shown per page
  setResultsPerPage: (value: number) => void // Set max number of results shown per page (1-100)
};
```

## Examples

### Default Layout

<ComponentContainer>
<Counterparties type="payee" />
  ```jsx
<Counterparties type="payee" />
  ```
</ComponentContainer>

### Custom Design

<ComponentContainer>
<Counterparties 
type="payee"
children={({
      setSearch,
      dataLoaded,
      hasNext,
      getNext,
      hasPrevious,
      getPrevious,
      resultsPerPage,
      setResultsPerPage,
      counterparties,
    }) => {
      return (
        <table className="mercoa-min-w-full mercoa-leading-normal">
          {/* We are using Tailwind CSS in this example */}
          <thead>
            <tr>
              {['Vendor', 'Total bills', 'Total Payments'].map((text, index) => (
                <th
                  key={index}
                  className="mercoa-px-5 mercoa-py-3 mercoa-border-b-2 mercoa-text-left mercoa-text-xs mercoa-font-semibold mercoa-text-gray-600 mercoa-uppercase tracking-wider"
                >
                  {text}
                </th>
              ))}
            </tr>
          </thead>
          <tbody>
            {counterparties.map((counterparty, rowIndex) => (
              <tr key={rowIndex} className="mercoa-cursor-pointer hover:mercoa-bg-gray-100 mercoa-bg-white">
                <td className="mercoa-px-5 mercoa-py-5 mercoa-border-b mercoa-border-gray-200 mercoa-text-sm">
                  <span className="mercoa-inline-flex mercoa-h-7 mercoa-w-7 mercoa-items-center mercoa-justify-center mercoa-rounded-full mercoa-bg-[#F6F3EE] mercoa-mr-2">
                    <span className="mercoa-text-xs mercoa-font-medium mercoa-leading-none mercoa-text-gray-800">
                      {counterparty?.name.charAt(0) ?? '' + counterparty?.name.charAt(1)}
                    </span>
                  </span>
                  {counterparty.name}
                </td>
                <td className="mercoa-px-5 mercoa-py-5 mercoa-border-b mercoa-border-gray-200 mercoa-text-sm">
                  {counterparty.invoiceMetrics?.totalCount}
                </td>
                <td className="mercoa-px-5 mercoa-py-5 mercoa-border-b mercoa-border-gray-200 mercoa-text-sm">
                  $ {counterparty.invoiceMetrics?.totalAmount}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )
    }
    }
  />
  ```jsx
<Counterparties type="payee">
({setSearch, dataLoaded, hasNext, getNext, hasPrevious, getPrevious, resultsPerPage, setResultsPerPage, counterparties }) => {
  return (
    <table className="min-w-full leading-normal">
      {/* We are using tailwind CSS in this example */}
      <thead>
        <tr>
          {['Vendor', 'Total bills', 'Total Payments'].map((text, index) => (
            <th
              key={index}
              className="px-5 py-3 border-b-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
            >
              {text}
            </th>
          ))}
        </tr>
      </thead>
      <tbody>
        {counterparties.map((counterparty, rowIndex) => (
          <tr key={rowIndex} className="cursor-pointer hover:bg-gray-100 bg-white">
            <td className="px-5 py-5 border-b border-gray-200 text-sm">
              <span className="inline-flex h-7 w-7 items-center justify-center rounded-full bg-[#F6F3EE] mr-2">
                <span className="text-xs font-medium leading-none text-gray-800">
                  {counterparty?.name.charAt(0) ?? '' + counterparty?.name.charAt(1)}
                </span>
              </span>
              {counterparty.name}
            </td>
            <td className="px-5 py-5 border-b border-gray-200 text-sm">
              {counterparty.invoiceMetrics?.totalCount}
            </td>
            <td className="px-5 py-5 border-b border-gray-200 text-sm">
              $ {counterparty.invoiceMetrics?.totalAmount}
            </td>
          </tr>
        ))}
      </tbody>
    </table>
  )}
  </PayablesTable>
  ```
  </ComponentContainer>
